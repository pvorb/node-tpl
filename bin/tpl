#!/usr/bin/env node

var optimist = require('optimist')
  .usage('Usage:\n'
      + 'tpl [file]\n'
      + 'tpl [-v|--version]\n'
      + 'tpl [-h|--help]')
  .options('v', {
    alias: 'version',
    describe: 'Show the version of this script'
  })
  .options('h', {
    alias: 'help',
    describe: 'This message'
  });
var argv = optimist.argv;

// Show version
if (argv.v) {
  console.log(require('tpl').version);
}
// Show help
else if (argv.h) {
  console.log(optimist.help());
}
// Show unknown command
else if (Object.keys(argv).length > 2) {
  console.error('Unknown command');
}
// Show help
else if (argv._.length == 0) {
  console.log(optimist.help());
}
// One file at a time
else if (argv._.length > 1) {
  console.error('tpl can only translate one file at a time.');
}
// Translate file
else {
  var file = require('path').resolve(process.cwd(), argv._[0]);

  require('tpl').apply(file, function(err, result) {
    console.log(result);
  });
}
